<% layout('./layouts/admin') %>

    <div class="row">
        <div class="col-sm-12">
            <h4 class="page-title">Appointment Manager</h4>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="<%= dashboard %>">Dashboard</a></li>

                <li class="breadcrumb-item">
                    <a href="<%= site_url %>booking">Appointment Manager</a>
                </li>
                <li class="breadcrumb-item active">View Appointment</li>
            </ol>
        </div>
    </div>


    <div class="row">
        <div class="col-lg-12"> 
            <ul class="nav nav-tabs tabs">
                <li class="active tab">
                    <a href="#home-2" data-toggle="tab" aria-expanded="false"> 
                        <span class="visible-xs"><i class="fa fa-user"></i></span> 
                        <span class="hidden-xs">Appointment Info</span> 
                    </a> 
                </li> 
                <li class="tab"> 
                    <a href="#profile-2" data-toggle="tab" aria-expanded="false"> 
                        <span class="visible-xs"><i class="fa fa-home"></i></span> 
                        <span class="hidden-xs">Shop Info</span> 
                    </a> 
                </li> 
            </ul> 
            <div class="tab-content"> 
                <div class="tab-pane active" id="home-2"> 
                    <div class="row">
                        <div class="col-lg-12">
                         
                                <div class="row">
                                    <div class="col-lg-10">
                                        <h4 class="m-t-0 m-b-20 header-title">Appointment Details</h4>
                                    </div>
                                <div class="col-lg-6">
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Req Id:</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.reqId %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>User Name :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.user && booking.user.fullName ? booking.user.fullName: "N/A" %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>User Mobile No. :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.user && booking.user.mobile ? booking.user.mobile : 'N/A' %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>User Email :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.user && booking.user.email ? booking.user.email : "N/A" %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>

            

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Time Slot :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <%= booking.timeSlot %>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Address :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <%= booking.address %>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Amount :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <%= booking.amount %>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Status :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                            <span><label data-id="tblStatus' + booking._id + '" class="badge" data-url="' + process.env.SITE_URL + 'barber/update_status/' + booking.shop._id + '/' + status + '">  <%= booking.status %>  </label></span>
                                            
                                            </div>
                                        </div>
                                    </div>

                
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Created At :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <%= FUNC.showDateFromString(booking.createdAt, 'MMM DD YYYY' ), %>
                                            </div>
                                        </div>
                                    </div>  
                                </div>

                                <div class="col-lg-12 m-t-10 ">
                                    <h4>Person Details</h4>
                                </div>
                                <div id="addressUser" imp !important;" class=" col-lg-12 table-responsive m-t-20">
                                    <table class="table table-actions-bar ">
                                        <thead>
                                            <tr style="text-align: center;">
                                                <th>Age</th>
                                                <th>gender</th>
                                                <th>Category</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% if(booking.person.length){ %>
                                                <% booking.person.map((e)=>{ %>
                                                    <tr style="text-align: center;">
                                                        <td>
                                                            <%= e.age %>
                                                        </td>
                                                        <td>
                                                            <%= e.gender %>
                                                        </td>
                                                        <td>
                                                            <%= e.isAdult == true ? "Adult" : "Child" %>
                                                        </td>
                                                        <td>
                                                            <%= e.text %>
                                                        </td>
                                                    </tr>
                                                <% }) %>
                                                <%  } %>
                                        </tbody>
                                    </table>
                                </div>

                                </div>
                        </div>
                    </div>
                </div> 
                <div class="tab-pane" id="profile-2">
                    <div class="row">
                        <div class="col-lg-12">
                         
                                <div class="row">
                                    <div class="col-lg-10">
                                        <h4 class="m-t-0 m-b-20 header-title">Shop Details</h4>
                                    </div>
                                <div class="col-lg-6">

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Shop Name :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.shop && booking.shop.name ? booking.shop.name : "-" %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Address:</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.shop && booking.shop.address ? booking.shop.address: "-" %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>logo :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <a href="<%= shopLogo %>" target="_blank">Click here</a>
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Experience :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.shop && booking.shop.experience ? booking.shop.experience: "-" %>
                                                 Years </p>
                                            </div>
                                        </div>
                                    </div>
                
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Address :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.shop && booking.shop.address ? booking.shop.address: "-" %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>description :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>
                                                    <%= booking.shop && booking.shop.description ? booking.shop.description : "-" %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <% if(booking.user && booking.user.shop){ %>
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <p><strong>Created At :</strong></p>
                                            </div>
                                            <div class="col-lg-8">
                                                <%= FUNC.showDateFromString(booking.shop.createdAt, 'MMM DD YYYY' ), %>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                    <% if(user.shop.status == false){ %>
                                        <div class="col-lg-2">
                                            <a href="/barber/confirmShop/<%= booking.user.shop._id %>" class="btn btn-success">Confirm Shop</a>
                                        </div>
                                        <% } %>
                                    </div>
                                </div>
                
                                </div>

                                <div class="col-lg-6">
                                    <div class="col-lg-12 m-t-10">
                                        <div class="row">
                                          
                                            <div style="margin: 0px auto;" class="col-lg-4">
                                            <img class="logoImg" src="<%= shopLogo %>">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                
                                    <div class="col-lg-12 m-t-10 ">
                                        <h4>Portfolio</h4>
                                    </div>
                                    <div id="addressUser" imp !important;" class=" col-lg-12 table-responsive m-t-20">
                                        <table class="table table-actions-bar ">
                                            <thead>
                                                <tr style="text-align: center;">
                                                    <th>Name</th>
                                                    <th>image</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% if(booking.user.shop.portfolio.length){ %>
                                                    <% booking.user.shop.portfolio.map((e)=>{ %>
                                                        <tr style="text-align: center;">
                                                            <td>
                                                                <%= e.name %>
                                                            </td>
                                                            <td>
                                                                <a href="<%= S3URL + e.image %>" target="_blank"><img class="ListImg" src="<%= S3URL + e.image %>"></a>
                                                            </td>
                                                        </tr>
                                                    <% }) %>
                                                    <%  } %>
                                            </tbody>
                                        </table>
                                    </div>

                                    <div class="col-lg-12 m-t-10 ">
                                        <h4>Availability Details</h4>
                                    </div>
                                    <div id="addressUser" imp !important;" class=" col-lg-12 table-responsive m-t-20">
                                        <table class="table table-actions-bar ">
                                            <thead>
                                                <tr style="text-align: center;">
                                                    <th>Day</th>
                                                    <th>Start Time</th>
                                                    <th>End Time</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% if(user.shop.availability.length){ %>
                                                    <% user.shop.availability.map((e)=>{ %>
                                                    <tr style="text-align: center;">
                                                        <td class="multiline tableWidth">
                                                            <%= e.day %>
                                                        </td>
                                                        <td class="multiline tableWidth">
                                                            <%= e.startTime %>
                                                        </td>
                                                        <td class="tableWidth">
                                                            <%= e.endTime %>
                                                        </td>
                                                    </tr>
                                                    <% }) %>
                                                    <%  } %>
                                            </tbody>
                                        </table>
                                    </div>  
                                    <% } %>                                  
                                </div>
                        </div>
                    </div>
                </div> 
            </div> 
        </div> 

    </div>